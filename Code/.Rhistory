?file.copy
write.xlsx(round(CEO.correlations$r,2), "01_CEO_correlations.xlsx", sheetName="R")
write.xlsx(round(CEO.correlations$P,2), file="01_CEO_correlations.xlsx", sheetName="P values", append=T)
file.copy(from="01_CEO_correlations.xlsx", to="~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results)
file.copy(from="01_CEO_correlations.xlsx", to="~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results")
file.remove("01_CEO_correlations.xlsx")
Ratioplot.outliers<- ggplot(CEO.outliers, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve (And Outliers)") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratioplot.outliers
Ratioplot.nooutliers<-ggplot(CEO.analyze, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratioplot.nooutliers
Ratioplot.outliers<- ggplot(CEO.outliers, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve (And Outliers)") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratioplot.outliers
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
WLBplot
Compplot<- ggplot(CEO.analyze, aes(comp)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$comp, na.rm=T), sd=sd(CEO.analyze$comp, na.rm=T))) +
xlab("Compensation & Benefits Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Compensation & Benefits Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Compplot
Ratio.WLB.plot <- ggplot(CEO.analyze, aes(x=ratio, y=wlb)) +
geom_smooth(method=lm, se=F) +
geom_point(shape=1) +
xlab("CEO Ratio") +
ylab("Work/Life Balance Ratings") +
coord_cartesian(xlim=c(0,1250), ylim=c(2,4.5)) +
scale_x_continuous(breaks=seq(0, 1250, 250)) +
scale_y_continuous(breaks=seq(2, 4.5, .5)) +
theme_classic() +
ggtitle("CEO Ratio & Work/Life Balance Ratings") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="blue"),
legend.position="none")
Ratio.WLB.plot
Ratio.Comp.plot <- ggplot(CEO.analyze, aes(x=ratio, y=comp)) +
geom_smooth(method=lm, se=F) +
geom_point(shape=1) +
xlab("CEO Ratio") +
ylab("Compensation & Benefits Ratings") +
coord_cartesian(xlim=c(0,1250), ylim=c(2,5)) +
scale_x_continuous(breaks=seq(0, 1250, 250)) +
scale_y_continuous(breaks=seq(2, 5, .5)) +
theme_classic() +
ggtitle("CEO Ratio & Compensation and Benefits Ratings") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="blue"),
legend.position="none")
Ratio.Comp.plot
grid.arrange(Ratioplot.outliers, Ratioplot.nooutliers)
plots <- arrangeGrob(Ratioplot.outliers, Ratioplot.nooutliers, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/02_ratio-univariate-graphs.pdf", plots)
?ggsave
ratioplots <- arrangeGrob(Ratioplot.outliers, Ratioplot.nooutliers, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/02_ratio-univariate-graphs.pdf", ratioplots,
width=5, height=10, units="in")
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/02_ratio-univariate-graphs.pdf", ratioplots,
width=4, height=8, units="in")
?arrangeGrob
wlbcompplots <- arrangeGrob(Ratio.WLB.plot, Ratio.Comp.plot, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=4, height=8, units="in")
wlbcompplots <- arrangeGrob(WLBplot, Compplot, nrow=2)
wlbcompplots <- arrangeGrob(WLBplot, Compplot, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=4, height=8, units="in")
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=5, height=10, units="in")
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=4, height=7, units="in")
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none", plot.title = element_text(hjust = 0.5))
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none", hjust = 0.5)
?pdf
?jpg
?jpeg
?dev.off
jpeg("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.jpeg")
Ratio.Comp.plot
dev.off()
jpeg("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.jpeg", res=300)
Ratio.Comp.plot
Ratio.Comp.plot
dev.off()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.pdf")
Ratio.Comp.plot
dev.off()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.pdf",
height=4, width=4, units="in")
Ratio.Comp.plot
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.pdf",
height=4, width=4)
Ratio.Comp.plot
dev.off()
dev.off()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.pdf")
Ratio.Comp.plot
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/06_ratio-comp-scatterplot.pdf")
Ratio.Comp.plot
dev.off()
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(xlsx)
CEO.outliers <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/03_CEO_outliers.csv", header=T) #Load outlier data for graphing
CEO.analyze <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/04_CEO_analyze.csv", header=T) #Load Analysis Data
CEO.correlations <- rcorr(as.matrix(CEO.analyze[c("ratio","overall", "culturevalues", "wlb",
"careerops", "comp", "srleadership",
"ceopctApprove", "rectofriend"
)]), type="pearson")
objects(CEO.correlations) #Hmisc correlations breaks down the objects very nicely
round(cbind(CEO.correlations$r[,1], CEO.correlations$P[,1]),2)
write.xlsx(round(CEO.correlations$P,2), file="01_CEO_correlations.xlsx", sheetName="P values", append=T)
file.copy(from="01_CEO_correlations.xlsx", to="~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results")
file.remove("01_CEO_correlations.xlsx")
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-histogram.pdf")
WLBplot
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none", hjust = 0.5)
dev.off()
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(xlsx)
CEO.outliers <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/03_CEO_outliers.csv", header=T) #Load outlier data for graphing
CEO.analyze <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/04_CEO_analyze.csv", header=T) #Load Analysis Data
CEO.correlations <- rcorr(as.matrix(CEO.analyze[c("ratio","overall", "culturevalues", "wlb",
"careerops", "comp", "srleadership",
"ceopctApprove", "rectofriend"
)]), type="pearson")
objects(CEO.correlations) #Hmisc correlations breaks down the objects very nicely
#Primarily interested in relationship b/t CEO ratio & other variables
#so lets look at just that
round(cbind(CEO.correlations$r[,1], CEO.correlations$P[,1]),2)
#Okay, so it appears there is a significant relationship b/t ratio and ratings of work/life balance
#and ratio and ratings of compensation and benefits
#And for good measure, I always save my correlations into a xlsx for later reference
write.xlsx(round(CEO.correlations$r,2), "01_CEO_correlations.xlsx", sheetName="R")
write.xlsx(round(CEO.correlations$P,2), file="01_CEO_correlations.xlsx", sheetName="P values", append=T)
file.copy(from="01_CEO_correlations.xlsx", to="~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results")
file.remove("01_CEO_correlations.xlsx")
Ratioplot.outliers<- ggplot(CEO.outliers, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve (And Outliers)") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratioplot.outliers
Ratioplot.nooutliers<-ggplot(CEO.analyze, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratioplot.nooutliers
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"))
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-histogram.pdf")
WLBplot
png("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-histogram.png")
WLBplot
dev.off()
graphics.off()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-histogram.pdf")
WLBplot
graphics.off()
dev.off()
dev.cur()
dev.list()
graphics.off()
dev.off()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-histogram.pdf")
WLBplot
dev.off()
graphics.off()
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(xlsx)
CEO.outliers <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/03_CEO_outliers.csv", header=T) #Load outlier data for graphing
CEO.analyze <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/04_CEO_analyze.csv", header=T) #Load Analysis Data
#I like using the Hmisc rcorr to run correlations because
#you can easily load the values into a csv
CEO.correlations <- rcorr(as.matrix(CEO.analyze[c("ratio","overall", "culturevalues", "wlb",
"careerops", "comp", "srleadership",
"ceopctApprove", "rectofriend"
)]), type="pearson")
objects(CEO.correlations) #Hmisc correlations breaks down the objects very nicely
#Primarily interested in relationship b/t CEO ratio & other variables
#so lets look at just that
round(cbind(CEO.correlations$r[,1], CEO.correlations$P[,1]),2)
#Okay, so it appears there is a significant relationship b/t ratio and ratings of work/life balance
#and ratio and ratings of compensation and benefits
#And for good measure, I always save my correlations into a xlsx for later reference
write.xlsx(round(CEO.correlations$r,2), "01_CEO_correlations.xlsx", sheetName="R")
write.xlsx(round(CEO.correlations$P,2), file="01_CEO_correlations.xlsx", sheetName="P values", append=T)
file.copy(from="01_CEO_correlations.xlsx", to="~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results")
file.remove("01_CEO_correlations.xlsx")
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"))
WLBplot
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/035_wlb-histogram.pdf")
WLBplot
dev.off()
?dev.off
x11()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/035_wlb-histogram.pdf")
WLBplot
dev.off()
graphics.off()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/035_wlb-histogram.pdf")
x11()
dev.new()
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/035_wlb-histogram.pdf")
WLBplot
dev.off()
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(xlsx)
CEO.outliers <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/03_CEO_outliers.csv", header=T) #Load outlier data for graphing
CEO.analyze <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/04_CEO_analyze.csv", header=T) #Load Analysis Data
x11()
x11()
WLBplot
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"))
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/035_wlb-histogram.pdf")
x11()
WLBplot
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(xlsx)
CEO.outliers <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/03_CEO_outliers.csv", header=T) #Load outlier data for graphing
CEO.analyze <-read.csv("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Data/04_CEO_analyze.csv", header=T) #Load Analysis Data
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"))
pdf("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/035_wlb-histogram.pdf")
WLBplot
dev.off()
Compplot<- ggplot(CEO.analyze, aes(comp)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$comp, na.rm=T), sd=sd(CEO.analyze$comp, na.rm=T))) +
xlab("Compensation & Benefits Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Compensation & Benefits Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
wlbcompplots <- arrangeGrob(WLBplot, Compplot, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=4, height=7, units="in")
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=5, height=7, units="in")
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots,
width=5, height=7, units="in")
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots)
Ratioplot.outliers<- ggplot(CEO.outliers, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve (And Outliers)") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratioplot.outliers
Ratioplot.nooutliers<-ggplot(CEO.analyze, aes(ratio)) +
geom_histogram(aes(y=..density..), binwidth = 30, colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$ratio, na.rm=T), sd=sd(CEO.analyze$ratio, na.rm=T))) +
xlab("CEO Ratio") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of CEO-to-worker\nCompensation Ratios with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
WLBplot <- ggplot(CEO.analyze, aes(wlb)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$wlb, na.rm=T), sd=sd(CEO.analyze$wlb, na.rm=T))) +
xlab("Work/Life Balance Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Work/Life Balance Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"))
x11()
WLBplot
WLBplot
Compplot<- ggplot(CEO.analyze, aes(comp)) +
geom_histogram(aes(y=..density..), colour="black", fill="white") +
stat_function(fun=dnorm, args=list(mean=mean(CEO.analyze$comp, na.rm=T), sd=sd(CEO.analyze$comp, na.rm=T))) +
xlab("Compensation & Benefits Ratings") +
ylab("Density") +
theme_classic() +
ggtitle("Histogram of Compensation & Benefits Ratings with\n a Normal Curve") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="red"),
legend.position="none")
Ratio.WLB.plot <- ggplot(CEO.analyze, aes(x=ratio, y=wlb)) +
geom_smooth(method=lm, se=F) +
geom_point(shape=1) +
xlab("CEO Ratio") +
ylab("Work/Life Balance Ratings") +
coord_cartesian(xlim=c(0,1250), ylim=c(2,4.5)) +
scale_x_continuous(breaks=seq(0, 1250, 250)) +
scale_y_continuous(breaks=seq(2, 4.5, .5)) +
theme_classic() +
ggtitle("CEO Ratio & Work/Life Balance Ratings") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="blue"),
legend.position="none")
Ratio.WLB.plot
Ratio.Comp.plot <- ggplot(CEO.analyze, aes(x=ratio, y=comp)) +
geom_smooth(method=lm, se=F) +
geom_point(shape=1) +
xlab("CEO Ratio") +
ylab("Compensation & Benefits Ratings") +
coord_cartesian(xlim=c(0,1250), ylim=c(2,5)) +
scale_x_continuous(breaks=seq(0, 1250, 250)) +
scale_y_continuous(breaks=seq(2, 5, .5)) +
theme_classic() +
ggtitle("CEO Ratio & Compensation and Benefits Ratings") +
theme(axis.title.x = element_text(face="bold", size=12), axis.title.y = element_text(face="bold",size=12),
axis.text.x = element_text(size=12), axis.text.y = element_text(size=12),
axis.line.x = element_line(size = .5), axis.line.y = element_line(size = .5),
plot.title = element_text(size=15, face="bold", color="blue"),
legend.position="none")
Ratio.Comp.plot
scatterplots <- arrangeGrob(Ratio.WLB.plot, Ratio.Comp.plot, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", scatterplots)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/03_wlb-comp-univariate-graphs.pdf", wlbcompplots)
scatterplots <- arrangeGrob(Ratio.WLB.plot, Ratio.Comp.plot, nrow=2)
ggsave("~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results/04_wlb-comp-scatterplot-graphs.pdf", scatterplots)
summary(CEO.analyze$profits)
summary(CEO.analyze$numberOfRatings)
summary(lm(scale(wlb) ~ scale(ratio) + scale(size) + scale(profits) + scale(numberOfRatings), data=CEO.analyze)) #ratio still significantly negatively predicts work/life balance ratings
as.data.frame(summary(lm(scale(wlb) ~ scale(ratio) + scale(size) + scale(profits) + scale(numberOfRatings), data=CEO.analyze))) #ratio still significantly negatively predicts work/life balance ratings
wlb.reg <- summary(lm(scale(wlb) ~ scale(ratio) + scale(size) + scale(profits) + scale(numberOfRatings), data=CEO.analyze)) #ratio still significantly negatively predicts work/life balance ratings
wlb.reg
wlb.reg$coefficients
as.data.frame(wlb.reg$coefficients)
round(as.data.frame(wlb.reg$coefficients),2)
round(as.data.frame(comp.reg$coefficients),2)
comp.reg <- summary(lm(scale(comp) ~ scale(ratio) + scale(size) + scale(profits) + scale(numberOfRatings), data=CEO.analyze)) #ratio still significantly negatively predicts compensation/benefits ratings
comp.reg
round(as.data.frame(comp.reg$coefficients),2)
write.xlsx(round(as.data.frame(wlb.reg$coefficients),2), "05_regressions.xlsx", sheetName="WLB")
write.xlsx(round(as.data.frame(comp.reg$coefficients),2), file="05_regressions.xlsx", sheetName="Comp", append=T)
file.copy(from="05_regressions.xlsx", to="~/Box Sync/Berkeley/Fall 2016/PolSci239T/PS239T-final-project/Results")
file.remove("05_regressions.xlsx")
knitr::opts_chunk$set(echo = TRUE)
###Install and Load Libraries
install.packages(c("Hmisc", "ggplot2", "gridExtra", "xlsx"), repos="http://cran.rstudio.com/")
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(xlsx)
class(CEO.analyze$profits)
class(CEO.analyze$profits)
class(CEO.analyze$numberOfRatings)
class(CEO.analyze$size)
class(CEO.analyze$profits)
class(CEO.analyze$numberOfRatings)
